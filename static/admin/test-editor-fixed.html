<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>–¢–µ—Å—Ç –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ</title>
    <link href="decap/decap-cms.css" rel="stylesheet">
    <script src="decap/decap-cms.js"></script>
    <style>
        body { 
            margin: 0; 
            font-family: Arial; 
            background: #f5f5f5;
        }
        .status { 
            padding: 20px; 
            margin: 20px; 
            border-radius: 10px; 
            text-align: center; 
        }
        .success { background: #27ae60; color: white; }
        .loading { background: #f39c12; color: white; }
        .error { background: #e74c3c; color: white; }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è Decap CMS */
        #cms-root {
            min-height: 100vh;
        }
    </style>
</head>
<body>
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –î–û –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <div id="cms-root"></div>

    <div id="status" class="status loading">
        <h2>üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–¥–∞–∫—Ç–æ—Ä...</h2>
        <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã Decap CMS</p>
    </div>

    <script>
        console.log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω –ª–∏ Decap CMS...');
        
        // –ñ–¥–µ–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeEditor, 1000);
        });

        function initializeEditor() {
            if (typeof DecapCMS === 'undefined') {
                document.getElementById('status').className = 'status error';
                document.getElementById('status').innerHTML = `
                    <h2>‚ùå Decap CMS –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è</h2>
                    <p>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</p>
                `;
                return;
            }

            console.log('‚úÖ Decap CMS –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º...');
            
            try {
                const config = {
                    backend: {
                        name: "test-repo"
                    },
                    locale: 'ru',
                    media_folder: "static/images/uploads",
                    public_folder: "/images/uploads",
                    collections: [
                        {
                            name: "gallery",
                            label: "üì∑ –ì–∞–ª–µ—Ä–µ–∏",
                            folder: "content/gallery",
                            create: true,
                            slug: "{{slug}}",
                            fields: [
                                {
                                    label: "–ù–∞–∑–≤–∞–Ω–∏–µ –∞–ª—å–±–æ–º–∞", 
                                    name: "title", 
                                    widget: "string",
                                    required: true
                                },
                                {
                                    label: "–û–ø–∏—Å–∞–Ω–∏–µ", 
                                    name: "description", 
                                    widget: "text"
                                },
                                {
                                    label: "–ö–∞—Ç–µ–≥–æ—Ä–∏—è", 
                                    name: "category", 
                                    widget: "select", 
                                    options: [
                                        { label: "üíí –°–≤–∞–¥—å–±—ã", value: "—Å–≤–∞–¥—å–±—ã" },
                                        { label: "üì∏ –ü–æ—Ä—Ç—Ä–µ—Ç—ã", value: "–ø–æ—Ä—Ç—Ä–µ—Ç—ã" },
                                        { label: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –°–µ–º–µ–π–Ω—ã–µ", value: "—Å–µ–º–µ–π–Ω—ã–µ" },
                                        { label: "üéâ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", value: "–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è" }
                                    ]
                                },
                                {
                                    label: "–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏", 
                                    name: "images", 
                                    widget: "list",
                                    field: {
                                        label: "–§–æ—Ç–æ", 
                                        name: "image", 
                                        widget: "image"
                                    }
                                }
                            ]
                        }
                    ]
                };

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Decap CMS
                DecapCMS.init({ config });
                
                document.getElementById('status').className = 'status success';
                document.getElementById('status').innerHTML = `
                    <h2>üéâ –û—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!</h2>
                    <p>Decap CMS —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω</p>
                    <p>–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∞–ª–µ—Ä–µ–∏ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</p>
                `;
                
                console.log('‚úÖ Decap CMS –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ!');
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                document.getElementById('status').className = 'status error';
                document.getElementById('status').innerHTML = `
                    <h2>‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</h2>
                    <p>${error.message}</p>
                    <p>–ü–æ–ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥...</p>
                    <button onclick="tryAlternativeMethod()" style="background: white; color: #e74c3c; border: none; padding: 10px 20px; border-radius: 5px; margin: 10px; cursor: pointer;">
                        üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥
                    </button>
                `;
            }
        }

        function tryAlternativeMethod() {
            // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            if (window.CMS) {
                console.log('üîÑ –ü—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ window.CMS...');
                window.CMS.registerBackend('test-repo', {});
            } else {
                alert('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏. –ù—É–∂–Ω–∞ –æ—Ç–ª–∞–¥–∫–∞.');
            }
        }
    </script>
</body>
</html>